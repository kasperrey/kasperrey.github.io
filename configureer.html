<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Letterkuil</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">
    <style>
        .hg-button.key-geselecteerd {
            background-color: #006e08;
        }
        .hg-button.key-grootte {
            max-width: 70px;
        }
    </style>
</head>
<body>
<script src="./alles_met_localstorage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>

<canvas width="1500px" height="500px" id="canvas"></canvas>
<input class="input" placeholder="selecteer de letters op het toetsenbord" style="position: absolute; top: 630px; left: 550px; width: 590px"/>
<div class="simple-keyboard" style="max-width: 600px; position: absolute; top: 700px; left: 550px"></div>
<button onclick="selectAlles()" id="selectallles" style="position: absolute; top: 655px; left: 700px; font: 30px Arial">selecteer alle letters</button>
<button onclick="window.location.assign('spel.html')" style="position: absolute; top: 200px; left: 300px;font: 100px Arial">start</button>
<button onclick="window.location.assign('letterkuil.html')" style="position: absolute; top: 200px; left: 1000px; font: 100px Arial">wissel van speler</button>
<button onclick="window.location.assign('winkel.html')" style="font: 30px Arial; position: absolute; top: 630px; left: 1300px">winkel</button>

<script>
  const Keyboard = window.SimpleKeyboard.default;

  const myKeyboard = new Keyboard({
      onChange: input => onChange(input),
      onKeyPress: button => onKeyPress(button)
  });
  myKeyboard.setOptions({
      layout: {
          'default': [
              `² & é " ' ( § è ! ç à ) - {bksp}`,
              '{tab} a z e r t y u i o p ^ $ {enter}',
              '{lock} q s d f g h j k l m ù µ {enter}',
              '{shift} < w x c v b n , ; : = {shift}',
              '{ctrl} {alt} {space} {altgr} {ctrl}'
          ],
          'shift': [
              '³ 1 2 3 4 5 6 7 8 9 0 ° _ {bksp}',
              '{tab} A Z E R T Y U I O P ¨ * {enter}',
              '{lock} Q S D F G H J K L M % £ {enter}',
              '{shift} > W X C V B N ? . / + {shift}',
              '{ctrl} {alt} {space} {altgr} {ctrl}'
          ],
          'AltGr': [
              '¬ | @ # ¼ ½ ^ { [ { } \\ ¸ {bksp}',
              '{tab} @ ł € ¶ ŧ ← ↓ → œ þ [ ] {enter}',
              '{lock} æ ß ð đ ŋ ħ ˀ ĸ ł \' \' \` {enter}',
              '{shift} \\ « » ¢ “ ” n ¸ ─ · ~ {shift}',
              '{ctrl} {alt} {space} {altgr} {ctrl}'
          ]
      },
      display: {
          '{bksp}': 'backspace',
          '{enter}': 'enter',
          '{tab}': 'tab',
          '{lock}': 'lock',
          '{shift}': 'shift',
          '{ctrl}': 'Ctrl',
          '{alt}': 'Alt',
          '{space}': ' ',
          '{altgr}': 'AltGr',
      }
  });

  myKeyboard.addButtonTheme("{ctrl} {alt} {altgr}", "key-grootte")

  var puut = new Audio("Puut-kort.mp3")
  var x = 20
  var geselecteerdeLetters = []
  var alfabet = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]
  var persoon = window.alles_met_localstorage.getGeselecteerd_persoon()

  var canvas = document.getElementById("canvas")
  var c = canvas.getContext('2d');
  c.font = "30px Arial"

  c.fillText(persoon.naam.replace("letterkuil-speler-", ""), 20, 20)
  c.fillText("hoogste level: "+persoon.level, 400, 20)
  c.fillText("diamanten: "+persoon.diamanten, 700, 20)

  function selectAlles() {
      var button = document.getElementById("selectallles")
      for (var l of alfabet) {
          if (geselecteerdeLetters.indexOf(l)>-1) {
              geselecteerdeLetters.splice(geselecteerdeLetters.indexOf(l), 1)
          }
      }
      if (button.innerText === "selecteer alle letters") {
          for (var letter of alfabet) {
              geselecteerdeLetters.push(letter)
          }
          myKeyboard.addButtonTheme(alfabet.join(" "), "key-geselecteerd")
          button.innerText = "maak leeg"
      } else {
          myKeyboard.removeButtonTheme(alfabet.join(" "), "key-geselecteerd")
          button.innerText = "selecteer alle letters"
      }
      window.alles_met_localstorage.setGeselecteerde_letters(geselecteerdeLetters)
      onChange()
  }

  function onChange(input) {
      document.getElementsByClassName("input").item(0).value = geselecteerdeLetters.join(" ")
  }

  function onKeyPress(button) {
      if (button === "{shift}" || button === "{lock}") {
          handleShift();
      } else if (button === "{altgr}") {
          handleAlt();
      } else if (button === "{bksp}" || button === "{tab}" || button === "{enter}" || button === "{space}" || button === "{ctrl}" || button === "{alt}") {
          puut.play()
      } else {
          if (geselecteerdeLetters.indexOf(button) > -1) {
              geselecteerdeLetters.splice(geselecteerdeLetters.indexOf(button), 1)
              myKeyboard.removeButtonTheme(button, "key-geselecteerd")
          } else {
              geselecteerdeLetters.push(button)
              myKeyboard.addButtonTheme(button, "key-geselecteerd")
          }
          window.alles_met_localstorage.setGeselecteerde_letters(geselecteerdeLetters)
      }
  }

  function handleShift() {
      let currentLayout = myKeyboard.options.layoutName;
      let shiftToggle = currentLayout === "default" ? "shift" : "default";
      myKeyboard.setOptions({
          layoutName: shiftToggle
      });
  }

  function handleAlt() {
      let currentLayout = myKeyboard.options.layoutName;
      let shiftToggle = currentLayout === "default" ? "AltGr" : "default";
      myKeyboard.setOptions({
          layoutName: shiftToggle
      });
  }
</script>
</body>
</html>